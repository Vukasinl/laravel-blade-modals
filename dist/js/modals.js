!function(factory){"function"==typeof define&&define.amd?define(factory):factory()}((function(){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var Modal=function(){function Modal(id){var _this=this,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,Modal),_defineProperty(this,"id",void 0),_defineProperty(this,"el",void 0),_defineProperty(this,"form",void 0),_defineProperty(this,"submitBtn",void 0),_defineProperty(this,"isAsync",void 0),_defineProperty(this,"isClosable",void 0),_defineProperty(this,"opened",void 0),_defineProperty(this,"shouldRemoveClasses",void 0),_defineProperty(this,"url",void 0),_defineProperty(this,"message",void 0),_defineProperty(this,"openListener",(function(event){event.preventDefault(),_this.setUrl(event.currentTarget.getAttribute("data-url")),_this.setMessage(event.currentTarget.getAttribute("data-message")),_this.open()})),_defineProperty(this,"closeListener",(function(event){_this.close()})),_defineProperty(this,"escapeCloseListener",(function(event){("key"in(event=event||window.event)?"Escape"===event.key||"Esc"===event.key:27===event.keyCode)&&_this.close()})),_defineProperty(this,"clickAwayListener",(function(event){_this.opened&&_this.shouldRemoveClasses&&_this.close(),_this.shouldRemoveClasses=!0})),_defineProperty(this,"innerClickListener",(function(event){_this.shouldRemoveClasses=!1})),_defineProperty(this,"submitListener",(function(event){event.preventDefault();var startSubmit=new CustomEvent(_this.id+"-submit",{detail:event});window.dispatchEvent(startSubmit);var formData=new FormData(_this.form);axios.post(_this.url,formData).then((function(response){_this.close();var successEvent=new CustomEvent(_this.id+"-success",{detail:response.data});window.dispatchEvent(successEvent)})).catch((function(error){var failEvent=new CustomEvent(_this.id+"-error",{detail:error.response.data});window.dispatchEvent(failEvent)})).finally((function(){}))})),this.id=id,this.el=document.querySelector('[data-modal="'.concat(id,'"]')),this.form=document.querySelector("#modal-form-".concat(id)),this.submitBtn=document.querySelector("#submit-modal-form-".concat(id)),this.isAsync=!!options.isAsync,this.isClosable=!!options.isClosable,this.opened=!1,this.shouldRemoveClasses=!0,this.url=options.url?options.url:"",this.message=""}var Constructor,protoProps,staticProps;return Constructor=Modal,(protoProps=[{key:"setUrl",value:function(value){value&&(this.url=value,this.el.querySelector(".modal__form").setAttribute("action",value))}},{key:"setMessage",value:function(value){this.message=value}},{key:"open",value:function(){if(!this.opened){document.querySelector("body").classList.add("modal-is-opened"),this.el.classList.add("overlay"),this.el.querySelector(".modal-default").classList.remove("modal--hidden"),this.el.querySelector(".js-modal").classList.add("modal__pop--index"),this.message&&(this.el.querySelector(".modal__form-text").innerHTML=this.message),this.opened=!0,this.shouldRemoveClasses=!1;var openedEvent=new CustomEvent(this.id+"-opened",{detail:event});window.dispatchEvent(openedEvent)}}},{key:"close",value:function(){document.querySelector("body").classList.remove("modal-is-opened"),this.el.classList.remove("overlay"),this.el.querySelector(".modal-default").classList.add("modal--hidden"),this.el.querySelector(".js-modal").classList.remove("modal__pop--index"),this.opened=!1,this.message="";var closedEvent=new CustomEvent(this.id+"-closed");window.dispatchEvent(closedEvent)}},{key:"registerListeners",value:function(){var _this2=this;document.querySelector(".js-open-"+this.id)&&document.querySelectorAll(".js-open-"+this.id).forEach((function(el){el.addEventListener("click",_this2.openListener)})),this.isClosable?(this.el.querySelectorAll(".js-close-modal").forEach((function(el){el.addEventListener("click",_this2.closeListener)})),document.querySelector("html").addEventListener("click",this.clickAwayListener),this.el.querySelector(".modal-default").addEventListener("click",this.innerClickListener),document.addEventListener("keydown",this.escapeCloseListener)):this.el.querySelectorAll(".js-close-modal").forEach((function(el){el.style.display="none"})),this.isAsync&&this.form.addEventListener("submit",this.submitListener)}},{key:"removeListeners",value:function(){var _this3=this;document.querySelector(".js-open-"+this.id)&&document.querySelectorAll(".js-open-"+this.id).forEach((function(el){el.removeEventListener("click",_this3.openListener)})),this.isClosable&&(this.el.querySelectorAll(".js-close-modal").forEach((function(element){element.removeEventListener("click",_this3.closeListener)})),document.querySelector("html").removeEventListener("click",this.clickAwayListener),this.el.querySelector(".modal-default").removeEventListener("click",this.innerClickListener),document.removeEventListener("keydown",this.escapeCloseListener)),this.isAsync&&this.form.removeEventListener("submit",this.submitListener)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Modal}();function initializeModals(){document.querySelectorAll("[data-modal]").forEach((function(el){var modal=new Modal(el.getAttribute("data-modal"),{isAsync:!!el.getAttribute("data-async"),isClosable:!!el.getAttribute("data-closable"),url:el.getAttribute("data-url")});modal.registerListeners(),el.getAttribute("data-start-opened")&&modal.open(),window.modals.push(modal)}))}window.modals=[],initializeModals(),document.addEventListener("livewire:load",(function(event){setTimeout((function(){window.livewire.hook("message.processed",(function(message,component){!function(){for(;window.modals.length;)window.modals.shift().removeListeners()}(),initializeModals()}))}),1e3)}))}));
//# sourceMappingURL=modals.js.map
